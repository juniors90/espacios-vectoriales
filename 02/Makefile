SOURCE=brochure_bak
LATEX=latexmk -recorder -xelatex -interaction=nonstopmode
LATEXCLEAN=latexmk -c
CLEANFILES=$(SOURCE).{nav,xdv,snm,ptb}

.PHONY: all
all: $(SOURCE).pdf


.PHONY: $(SOURCE).pdf
$(SOURCE).pdf: $(SOURCE).tex
	$(LATEX) $(SOURCE).tex


# Note: Neither clean nor mrproper touch the agda.sty generated by Agda
# in $(LATEXDIR), in case you want to customise it.

.PHONY: clean
clean:
	rm -f $(CLEANFILES) && \
	([ ! -f $(SOURCE).toc ] || $(LATEXCLEAN) $(SOURCE).toc) && \
	rm -f $(SOURCE).toc


.PHONY: mrproper
mrproper: clean
	rm -f $(SOURCE).{xdv,pdf}


# Generate the example image for this repo, using ImageMagick
talk.png: $(SOURCE).pdf
	gs -dSAFER -r600 -sDEVICE=pngalpha -o presentation.png $(SOURCE).pdf
